import { DeliveryMethodRepository } from '../../../domain/contracts/delivery-method.repository';
import { HttpService } from '../../../../../shared/domain/contracts/http';
import {
  DeliveryMethodByCountry,
  DeliveryMethodByFileType,
  DeliveryMethodByMalwareType
} from '../../../domain/models/delivery-method';
import { env } from '../../../../../../config/env';

export function deliveryMethodRepositoryBuilder({
  httpService
}: {
  httpService: HttpService;
}): DeliveryMethodRepository {
  return {
    async findByCountry(): Promise<DeliveryMethodByCountry[]> {
      const response = await httpService.get<DeliveryMethodByCountry[]>(
        `${env.API_URL}/kpis/delivery-methods?operation=count-by-country`
      );
      return response.data;
    },
    async findByMalwareType(): Promise<DeliveryMethodByMalwareType[]> {
      const response = await httpService.get<DeliveryMethodByMalwareType[]>(
        `${env.API_URL}/kpis/delivery-methods?operation=count-by-malware-type`
      );
      return response.data;
    },
    async findByFileType(): Promise<DeliveryMethodByFileType[]> {
      const response = await httpService.get<DeliveryMethodByFileType[]>(
        `${env.API_URL}/kpis/delivery-methods?operation=count-by-file-type`
      );
      return response.data;
    }
  };
}
